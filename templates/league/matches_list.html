{% extends "base.html" %}
{% block title %}Matches{% endblock %}

{% block content %}
<h2 class="mb-3">Matches</h2>

<form method="get" class="mb-3" style="display:flex;gap:8px;align-items:center;flex-wrap:wrap;">
  <label>
    <select name="sport" style="padding:8px;">
      <option value="">All sports</option>
      {% for s in sports %}
        <option value="{{ s.slug }}" {% if selected_sport == s.slug %}selected{% endif %}>{{ s.name }}</option>
      {% endfor %}
    </select>
  </label>

  <label>
    <select name="filter" style="padding:8px;">
      <option value="upcoming" {% if filter == "upcoming" %}selected{% endif %}>Upcoming</option>
      <option value="past" {% if filter == "past" %}selected{% endif %}>Past</option>
      <option value="all" {% if filter == "all" %}selected{% endif %}>All</option>
    </select>
  </label>

  <button class="btn" type="submit">Filter</button>
  <a class="btn" href="{% url 'add_match' %}">Add Match</a>
</form>

<div>
  {% for match in page_obj %}
    <div style="background:rgba(255,255,255,0.95);padding:12px;margin-bottom:8px;border-radius:6px;display:flex;justify-content:space-between;align-items:center;">
      <div>
        <a href="{% url 'match_detail' match.pk %}">
          <strong>
            {% if match.home_team %}
              {{ match.home_team.name }}
            {% else %}
              TBD
            {% endif %}
             vs
            {% if match.away_team %}
              {{ match.away_team.name }}
            {% else %}
              TBD
            {% endif %}
          </strong>
        </a>

        <div style="color:#666;font-size:13px;margin-top:4px;">
          {{ match.date_time }}
          {% if match.sport %}
            • {{ match.sport.name }}
          {% endif %}
        </div>
      </div>

      <div style="text-align:right;">
        {% if match.home_score is not None and match.away_score is not None %}
          <strong>{{ match.home_score }} — {{ match.away_score }}</strong>
        {% else %}
          <span style="color:#888">Not played</span>
        {% endif %}
      </div>
    </div>
  {% empty %}
    <p>No matches found. <a href="{% url 'add_match' %}">Schedule one</a>.</p>
  {% endfor %}
</div>

<nav aria-label="Matches pagination" style="margin-top:16px;">
  <ul style="list-style:none;display:flex;gap:8px;padding:0;align-items:center;">
    {% if page_obj.has_previous %}
      <li><a href="?page={{ page_obj.previous_page_number }}{% if selected_sport %}&sport={{ selected_sport }}{% endif %}{% if filter %}&filter={{ filter }}{% endif %}">Previous</a></li>
    {% else %}
      <li style="color:#999">Previous</li>
    {% endif %}

    <li style="margin:0 12px;color:#555">Page {{ page_obj.number }} of {{ page_obj.paginator.num_pages }}</li>

    {% if page_obj.has_next %}
      <li><a href="?page={{ page_obj.next_page_number }}{% if selected_sport %}&sport={{ selected_sport }}{% endif %}{% if filter %}&filter={{ filter }}{% endif %}">Next</a></li>
    {% else %}
      <li style="color:#999">Next</li>
    {% endif %}
  </ul>
</nav>
{% endblock %}
