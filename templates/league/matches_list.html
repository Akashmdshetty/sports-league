{% extends "base.html" %}
{% block title %}Matches{% endblock %}
{% block content %}
<h2 class="mb-3">Matches</h2>

<form method="get" class="mb-3 d-flex gap-2">
  <select name="sport" class="form-select" style="width:220px;">
    <option value="">All sports</option>
    {% for s in sports %}
      <option value="{{ s.slug }}" {% if selected_sport == s.slug %}selected{% endif %}>{{ s.name }}</option>
    {% endfor %}
  </select>
  <select name="filter" class="form-select" style="width:160px;">
    <option value="upcoming" {% if filter == "upcoming" %}selected{% endif %}>Upcoming</option>
    <option value="past" {% if filter == "past" %}selected{% endif %}>Past</option>
    <option value="all" {% if filter == "all" %}selected{% endif %}>All</option>
  </select>
  <button class="btn" type="submit">Filter</button>
  <a class="btn" href="{% url 'add_match' %}">Add Match</a>
</form>

<div class="list-group">
  {% for match in page_obj %}
  <div class="list-group-item">
    <div class="d-flex justify-content-between">
      <div>
        <strong><a href="{% url 'match_detail' match.pk %}">{{ match.home_team }} vs {{ match.away_team }}</a></strong>
        <div class="text-muted small">{{ match.date_time }} • {{ match.sport.name if match.sport }}</div>
      </div>
      <div class="text-end">
        {% if match.home_score is not None and match.away_score is not None %}
          <span>{{ match.home_score }} — {{ match.away_score }}</span>
        {% else %}
          <small class="text-muted">Not played</small>
        {% endif %}
      </div>
    </div>
  </div>
  {% empty %}
    <p>No matches scheduled. <a href="{% url 'add_match' %}">Schedule one</a>.</p>
  {% endfor %}
</div>

<nav class="mt-4">
  <ul class="pagination">
    {% if page_obj.has_previous %}
      <li class="page-item"><a class="page-link" href="?page={{ page_obj.previous_page_number }}">Previous</a></li>
    {% else %}
      <li class="page-item disabled"><span class="page-link">Previous</span></li>
    {% endif %}
    <li class="page-item disabled"><span class="page-link">Page {{ page_obj.number }} of {{ page_obj.paginator.num_pages }}</span></li>
    {% if page_obj.has_next %}
      <li class="page-item"><a class="page-link" href="?page={{ page_obj.next_page_number }}">Next</a></li>
    {% else %}
      <li class="page-item disabled"><span class="page-link">Next</span></li>
    {% endif %}
  </ul>
</nav>
{% endblock %}
